// Content from commit 021ba8faf74b841e5be112d9f908bed12b99c03c (2597 lines of code)
//... (full content follows here) ...